(self["webpackChunk_N_E"]=self["webpackChunk_N_E"]||[]).push([[974],{210:(e,s,t)=>{"use strict";t.d(s,{AuthProvider:()=>m,A:()=>v});var r=t(5155);var n=t(2115);var a=t(5695);var o=t(5404);var i=t(5317);var u=t(3915);const c={apiKey:"AIzaSyDeO4RNogxdrDxOJEWfAbsyr67jh19fIFc",authDomain:"gesticom-4e956.firebaseapp.com",projectId:"gesticom-4e956",storageBucket:"gesticom-4e956.firebasestorage.app",messagingSenderId:"158166010651",appId:"1:158166010651:web:58b14e98489ea9046a61be"};const d=!(0,u.Dk)().length?(0,u.Wp)(c):(0,u.Sx)();const l=(0,o.xI)(d);const f=(0,i.aU)(d,"gesticom");const h=(0,n.createContext)(undefined);const v=()=>{const e=(0,n.useContext)(h);if(e===undefined){throw new Error("useAuth must be used within an AuthProvider")}return e};const m=e=>{let{children:s}=e;const[t,u]=(0,n.useState)(null);const[c,d]=(0,n.useState)(null);const[v,m]=(0,n.useState)(true);const p=(0,a.useRouter)();(0,n.useEffect)(()=>{const e=(0,o.hg)(l,async e=>{if(e){const s=await e.getIdToken();d(s);const t=await (0,i.x7)((0,i.H9)(f,"usuarios",e.uid));if(t.exists()){const s=t.data();u({id:e.uid,nombre:s.nombre||"Usuario",rut:s.rut||"",email:e.email||"",rol:s.rol||"vendedor"})}}else{u(null);d(null)}m(false)});return()=>e()},[]);const b=async(e,s)=>{await (0,o.x9)(l,e,s);p.push("/inventario")};const g=async()=>{await (0,o.CI)(l);p.push("/login")};const x=e=>{if(!t)return false;const s=Array.isArray(e)?e:[e];return s.includes(t.rol)};return(0,r.jsx)(h.Provider,{value:{usuario:t,token:c,login:b,logout:g,isLoading:v,isAuthenticated:!!t,hasRole:x},children:s})}},1057:(e,s,t)=>{"use strict";t.r(s);t.d(s,{"default":()=>i});var r=t(5155);var n=t(2115);var a=t(5695);var o=t(210);function i(){const{isAuthenticated:e,isLoading:s,usuario:t}=(0,o.A)();const i=(0,a.useRouter)();(0,n.useEffect)(()=>{if(!s){if(e){if((t===null||t===void 0?void 0:t.rol)==="due\xf1o"){i.push("/dashboard")}else{i.push("/inventario")}}else{i.push("/login")}}},[e,s,i,t]);return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})}},6940:(e,s,t)=>{Promise.resolve().then(t.bind(t,1057))}},e=>{var s=s=>e(e.s=s);e.O(0,[135,204,896,441,684,358],()=>s(6940));var t=e.O();_N_E=t}]);